üß© Task Name: Employee Skill Tracker (Collection Mapping Example)
üéØ Objective:

Demonstrate how to map and store Java collections (List, Set, Map) inside a JPA entity using annotations like
@ElementCollection, @CollectionTable, and @MapKeyColumn.


üß± Class-Wise Design
1Ô∏è. Entity Class ‚Äî Employee

Purpose:
Represents an employee who possesses multiple skills, certifications, and project ratings.

Fields:

empId ‚Üí Unique identifier (Primary Key)

empName ‚Üí Employee‚Äôs name

skills ‚Üí A List of technical skills

certifications ‚Üí A Set of unique certifications

projectRatings ‚Üí A Map of project names and performance ratings

Responsibilities:

Use @ElementCollection to define each collection.

For each collection, use @CollectionTable to specify the table name and joining column.

For projectRatings, use @MapKeyColumn to define the key column (project name).

Include toString() and getter/setter methods for displaying and managing data.

2Ô∏è.Repository Interface ‚Äî EmployeeRepository

Purpose:
Provides database interaction for the Employee entity.

Type:
Extends JpaRepository<Employee, Long>

Responsibilities:

Support basic CRUD operations (save, findAll, findById, delete).

Add a custom JPQL query method to find employees by a particular skill name (join collection).
 @Query("SELECT e FROM Employee e JOIN e.skills s WHERE s = :skill")

Enable filtering employees based on specific skills using @Query and @Param.

3Ô∏è.Runner Class ‚Äî EmployeeRunner

Purpose:
Acts as the console-based test class to insert and display employee data at application startup.

Responsibilities:

Create multiple Employee objects with different collection data.

Populate skills, certifications, and projectRatings with sample values.

Save all employees using the repository.

Retrieve and print all employee data.

Demonstrate querying employees by a specific skill.

Use CommandLineRunner or ApplicationRunner interface to execute logic on startup.

ANS:

spring.application.name=BootProj55-CollectionMapping-EmployeeSkillTracker

#DataSource  cfg (mysql)
#spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
#spring.datasource.url=jdbc:mysql:///mydb
#spring.datasource.username=ravi
#spring.datasource.password=system


#DataSource  cfg (Oracle)
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver
spring.datasource.url=jdbc:oracle:thin:@localhost:1521:orcl
spring.datasource.username=ravi
spring.datasource.password=system


# hibernate-JPA properties
#spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect
spring.jpa.database-platform=org.hibernate.dialect.OracleDialect
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update


#enable lazy loading
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true






package com.ravi.entity;

import java.util.List;
import java.util.Map;
import java.util.Set;

import jakarta.persistence.CollectionTable;
import jakarta.persistence.Column;
import jakarta.persistence.ElementCollection;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.MapKeyColumn;
import jakarta.persistence.SequenceGenerator;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.NonNull;
import lombok.RequiredArgsConstructor;

@Data
@Entity
@Table(name = "EMPLOYEE_SKILL_TRACKER")
@AllArgsConstructor
@NoArgsConstructor
@RequiredArgsConstructor
public class Employee {

	@Id
	@SequenceGenerator(name = "gen1",sequenceName = "Employee_skills_seq",initialValue = 1001,allocationSize = 1)
	@GeneratedValue(generator = "gen1",strategy = GenerationType.SEQUENCE)
	private Integer empId;
	
	@NonNull
	@Column(name = "EMP_NAME",length = 20)
	private String empName;
	
	@NonNull
	@Column(name = "EMP_SKILLS")
	@ElementCollection
	@CollectionTable(name = "EMPLOYEE_SKILLS",joinColumns = @JoinColumn(name="EMPLOYEE_ID",referencedColumnName ="empId" ))
	private List<String> skills;
	
	@NonNull
	@Column(name = "EMP_CERTIFICATIONS")
	@ElementCollection
	@CollectionTable(name = "EMPLOYEE_CERTIFICATION",joinColumns = @JoinColumn(name="EMPLOYEE_ID",referencedColumnName = "empId"))
	private Set<String> certifications;
	
	@NonNull
	@Column(name = "EMP_PROJECT_RATINGS")
	@ElementCollection
	@CollectionTable(name = "EMPLOYEE_PROJECT_RATING",joinColumns = @JoinColumn(name="EMPLOYEE_ID",referencedColumnName = "empId"))
	@MapKeyColumn(name="PROJECT_NAME")
	private Map<String, String> projectRatings;
}



package com.ravi.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;

import com.ravi.entity.Employee;

public interface IEmployeeRepository extends JpaRepository<Employee,Integer> {
	
//	@Query("SELECT e FROM Employee e JOIN e.skills s WHERE s = ?1")//for single skill
	@Query("SELECT e FROM Employee e JOIN e.skills s WHERE s IN(?1)")//for multiple skills
			public List<Employee> findBySkills(List<String> skill);


}






package com.ravi.service;

import java.util.List;

import com.ravi.entity.Employee;

public interface IEmployeeService {

	public String registerEmployee(Employee employee);
	
	public String registerAllEmployee(List<Employee> employee);
	
	public List<Employee> showAllEmployee();
	
	
	public List<Employee> findEmployeeBySkill(List<String> skill);
}





package com.ravi.service;

import java.util.List;
import java.util.stream.Collectors;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.ravi.entity.Employee;
import com.ravi.repository.IEmployeeRepository;

@Service
public class EmployeeService implements IEmployeeService {

	@Autowired
	IEmployeeRepository repository;
	
	@Override
	public String registerEmployee(Employee employee) {
		Employee save = repository.save(employee);
		return "Employee register successfully with id: "+save.getEmpId();
	}
	
	@Override
	public String registerAllEmployee(List<Employee> employee) {
		List<Employee> saveAll = repository.saveAll(employee);
		List<Integer> ids = saveAll.stream().map(Employee::getEmpId).collect(Collectors.toList());
		return "List of empoyee save with ids value: "+ids;
	}
	
	@Override
	public List<Employee> showAllEmployee() {
		List<Employee> all = repository.findAll();
		return all;
	}

	@Override
	public List<Employee> findEmployeeBySkill(List<String> skill) {
	List<Employee> bySkills = repository.findBySkills(skill);
		
		return bySkills;
	}
}



package com.ravi.runner;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.Scanner;
import java.util.Set;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

import com.ravi.entity.Employee;
import com.ravi.repository.IEmployeeRepository;
import com.ravi.service.IEmployeeService;

@Component
public class EmployeeRunner implements CommandLineRunner {

	@Autowired
	IEmployeeService service;
	Scanner sc=new Scanner(System.in);
	@Override
	public void run(String... args) throws Exception {
		try {
			
//			Employee employee=new Employee("Rajesh", List.of("Java","Spring","React"), Set.of("Java","React"), Map.of("STUDENT MANAGEMENT SYSTEM","Good","PRODUCT MANAGEMENT SYSTEM","GREAT"));
//			String registerEmployee = service.registerEmployee(employee);
//			System.out.println(registerEmployee);
			
//			System.out.println("==============================");
			
//			Employee employee1=new Employee("Sachin", List.of("Java","Spring","React"), Set.of("Java","React"), Map.of("HR MANAGEMENT SYSTEM","Good","PRODUCT MANAGEMENT SYSTEM","GREAT"));
//			Employee employee2=new Employee("Manoj", List.of("Java","Spring","React"), Set.of("Java","React"), Map.of("INVENTORY MANAGEMENT SYSTEM","Good","PRODUCT MANAGEMENT SYSTEM","GREAT"));
//			Employee employee3=new Employee("Pintu", List.of("Java","Spring","React"), Set.of("Java","React"), Map.of("STUDENT MANAGEMENT SYSTEM","Good","PRODUCT MANAGEMENT SYSTEM","GREAT"));
//			
//			String registerAllEmployee = service.registerAllEmployee(List.of(employee1,employee2,employee3));
//			System.out.println(registerAllEmployee);
			
			
//			System.out.println("==============================");
			
			List<Employee> showAllEmployee = service.showAllEmployee();
			showAllEmployee.forEach(System.out::println);
			
//			System.out.println("==============================");
//			
//			System.out.print("how many skills u want to find: ");
//			int noOfSkills=Integer.parseInt(sc.nextLine());
//			
//			List<String > skills=new ArrayList<String>();
//			
//			for(int i=1;i<=noOfSkills;i++) {
//				System.out.print("Enter skills "+i+" :");
//				skills.add(sc.nextLine());
//			}
//			
//			System.out.print("Enter skill: ");
//			
//			List<Employee> employeeBySkill = service.findEmployeeBySkill(skills);
//			employeeBySkill.forEach(System.out::println);
		}catch(Exception e) {
			e.printStackTrace();
		}
		
		

	}

}









